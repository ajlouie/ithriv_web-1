<g
  *ngIf="options.relationship === 'root' && category"
  (mouseover)="category.hover = true"
  (mouseout)="category.hover = false"
>
  <rect
    stroke="white"
    fill="white"
    [attr.x]="-options.radius"
    [attr.y]="0"
    [attr.width]="options.radius * 2"
    [attr.height]="options.radius + options.titleHeight"
  />
  <rect
    [attr.stroke]="categoryColor(category.color, 0.1)"
    [attr.fill]="categoryColor(category.color, 0.1)"
    [attr.x]="-options.radius"
    [attr.y]="0"
    [attr.width]="options.radius * 2"
    [attr.height]="options.radius + options.titleHeight"
  />
  <rect
    [attr.stroke]="nodeGradient(category)"
    fill="none"
    [attr.x]="-options.radius + strokeWidth"
    [attr.y]="strokeWidth"
    [attr.width]="options.radius * 2 - strokeWidth * 2"
    [attr.height]="options.radius + options.titleHeight - strokeWidth * 2"
  />
  <text
    fill="black"
    [attr.x]="0"
    [attr.y]="options.radius + options.titleHeight / 2"
    text-anchor="middle"
  >
    {{ category.name }}
  </text>
  <circle
    cy="0"
    [attr.r]="options.radius"
    [attr.stroke]="category.color"
    fill="white"
  />
  <image
    *ngIf="category.level === 0"
    [attr.x]="-options.radius + strokeWidth + strokeWidth / 2"
    [attr.y]="-nodeImageSize() / 2"
    [attr.width]="nodeImageSize()"
    [attr.height]="nodeImageSize()"
    [attr.maxWidth]="nodeImageSize()"
    [attr.maxHeight]="nodeImageSize()"
    [attr.xlink:href]="nodeImagePath(category)"
    [attr.mask]="'url(#circleMask' + options.radius + ')'"
    preserveAspectRatio="xMidYMid slice"
  />
</g>

<g
  *ngIf="options.relationship === 'child'"
  (mouseover)="category.hover = true"
  (mouseout)="category.hover = false"
>
  <circle
    [attr.cx]="0"
    cy="0"
    [attr.r]="options.radius"
    [attr.stroke]="category.color"
    [attr.fill]="category.hover ? category.color : 'white'"
  />
  <image
    *ngIf="category.level === 0"
    [attr.x]="-nodeImageSize() / 2"
    [attr.y]="-nodeImageSize() / 2"
    [attr.width]="nodeImageSize()"
    [attr.height]="nodeImageSize()"
    [attr.xlink:href]="nodeImagePath(category)"
    preserveAspectRatio="xMidYMid slice"
  />
  <g
    *ngIf="category.level === 1"
    [inlineSVG]="category.icon.url"
    [attr.transform]="translateIcon()"
    [attr.fill]="category.hover ? 'white' : category.color"
  ></g>
  <text
    *ngIf="category.level > 0 && state !== 'tertiary'"
    text-anchor="middle"
    [attr.transform]="translateText(category)"
    [attr.fill]="category.hover ? 'white' : 'black'"
  >
    <tspan
      *ngFor="let word of words(category.name); let j = index"
      [attr.x]="0"
      [attr.y]="fontSize * j"
      class="category-name"
    >
      {{ word }}
    </tspan>
    <tspan
      *ngIf="category.level === 2"
      [attr.x]="0"
      [attr.y]="fontSize * words(category.name).length + fontSize"
    >
      {{ category.resource_count || 0 }} resources/events
    </tspan>
  </text>
</g>
